q()
clear
md <- load("Saanich.metadata.txt")
md <- load("DS_4/Saanich.metadata.txt")
md <- load("Saanich.metadata.txt")
ggplot(metadata, (x=O2_uM, y=Depth_m))
ggplot(metadata,(x=O2_uM, y=Depth_m))
ggplot(metadata,aes(x=O2_uM, y=Depth_m))
ggplot(metadata, aes(x=O2_uM, y=Depth_m))
library(tidyverse)
load("phyloseq_object.RData")
load("phyloseq_object.RData")
load("phyloseq_object.RData")
ggplot(metadata, aes(x=O2_uM, y=Depth_m))
View(physeq)
OTU <- load("Saanich.OTU.txt")
source("phyloseq_object.RData")
OTU <- source("Saanich.OTU.txt")
OTU <- read.delim("Saanich.OTU.txt")
load("phyloseq_object.RData")
ggplot(metadata, aes(x=O2_uM, y=Depth_m))
metadata <- read.delim("Saanich.metadata.txt")
ggplot(metadata, aes(x=O2_uM, y=Depth_m))
(tidyverse)
ggplot(metadata, aes(x=O2_uM, y=Depth_m), color="green")+
geom_point()
ggplot(metadata, aes(x=O2_uM, y=Depth_m), color="green")+
geom_point()
ggplot(metadata, aes(x=O2_uM, y=Depth_m, color="green"))+
geom_point()
ggplot(metadata, aes(x=O2_uM, y=Depth_m))+
geom_point(color="green")
ggplot(metadata, aes(x=O2_uM, y=Depth_m))+
geom_point(color="green", shape="triangle")
ggplot(metadata, aes(x=O2_uM, y=Depth_m))+
geom_point(color="green", shape="triangle", size =10)
ggplot(metadata, aes(x=O2_uM, y=Depth_m))+
geom_point(color="green", shape="square", size =10)
ggplot(metadata, aes(x=O2_uM, y=Depth_m))+
geom_point(color="green")
ggplot(metadata, aes(x=O2_uM, y=Depth_m))+
geom_point(shape="square")
, size =10)
, size =10)
, size =10)
ggplot(metadata, aes(x=O2_uM, y=Depth_m))+
geom_point(color="green")
ggplot(metadata, aes(x=O2_uM, y=Depth_m))+
geom_point(shape="square")
ggplot(metadata, aes(x=O2_uM, y=Depth_m), size=OxygenSBE_V)+
geom_point(color="green")
ggplot(metadata, aes(x=O2_uM, y=Depth_m), size=OxygenSBE_V)+
geom_point(size=10)
ggplot(metadata, aes(x=O2_uM, y=Depth_m), size=OxygenSBE_V)+
geom_point(size=4)
ggplot(metadata, aes(x=O2_uM, y=Depth_m), size=OxygenSBE_V)+
geom_point(shape=17)
ggplot(metadata, aes(x=O2_uM, y=Depth_m), size=OxygenSBE_V)+
geom_point(color = "red", shape=17)
View(metadata)
#Exercise 1
ggplot(metadata, aes(x=NO3_uM, y=Depth_m), size=OxygenSBE_V)+
geom_point(color = "purple", shape=17, size = 2)
#Exercise 1
ggplot(metadata, aes(x=NO3_uM, y=Depth_m), size=OxygenSBE_V)+
geom_point(color = "purple", shape=17, size = 3)
#Exercise 1
ggplot(metadata, aes(x=NO3_uM, y=Depth_m), size=OxygenSBE_V)+
geom_point(color = "purple", shape=17, size = 1)
#Exercise 2
#Change from °C to °F
metadata %>%
mutate(Temperature_F = (Temperature_C*9/5)+32)
#Plot data
ggplot(metadata, aes(x=Temperature_F, y=Depth_m ))+
geom_point()
#Exercise 2
#Change from °C to °F
metadata %>%
Temperature_F = mutate(Temperature_F = (Temperature_C*9/5)+32)
#Exercise 2
#Change from °C to °F
metadata %>%
mutate(Temperature_F = (Temperature_C*9/5)+32)
library(tidyverse)
ggplot(metadata, aes(x=Temperature_F, y=Depth_m ))+
geom_point()
#Exercise 2
#Change from °C to °F
metadata %>%
mutate(Temperature_F = (Temperature_C*9/5)+32) %>%
select(Temperature_F)
#Exercise 2
#Change from °C to °F
metadata %>%
mutate(Temperature_F = (Temperature_C*9/5)+32) %>%
select(Temperature_F) %>%
ggplot(metadata, aes(x=Temperature_F, y=Depth_m ))+
geom_point()
#Exercise 2
#Change from °C to °F
metadata %>%
mutate(Temperature_F = (Temperature_C*9/5)+32) %>%
select(Temperature_F) %>%
ggplot(metadata, aes(x=Temperature_F, y=Depth_m))+
geom_point()
#Exercise 2
#Change from °C to °F
metadata %>%
mutate(Temperature_F = (Temperature_C*9/5)+32) %>%
select(Temperature_F) %>%
ggplot(metadata, aes_(x=Temperature_F, y=Depth_m))+
geom_point()
#Exercise 2
#Change from °C to °F
metadata %>%
mutate(Temperature_F = (Temperature_C*9/5)+32) %>%
select(Temperature_F) %>%
ggplot(metadata, aes(x=Temperature_F, y=Depth_m))
#Exercise 2
#Change from °C to °F
metadata %>%
mutate(Temperature_F = (Temperature_C*9/5)+32) %>%
select(Temperature_F) %>%
ggplot(metadata, aes(x=Temperature_F, y=Depth_m))+
geom_point()
#Plot data
#Plot data
#Plot data
#Plot data
#Exercise 2
#Change from °C to °F
metadata %>%
mutate(Temperature_F = (Temperature_C*9/5)+32) %>%
select(Temperature_F) %>%
ggplot(metadata,aes(x=Temperature_F, y=Depth_m))+
geom_point()
dplyr
help("dplyr")
#Exercise 2
#Change from °C to °F
metadata %>%
mutate(Temperature_F = (Temperature_C*9/5)+32) %>%
select(Temperature_F) %>%
ggplot(metadata,aes(x=Temperature_F, y=Depth_m))
#Exercise 1
ggplot(metadata, aes(x=NO3_uM, y=Depth_m))+
geom_point(color = "purple", shape=17, size = 1)
metadata %>%
mutate(Temperature_F = (Temperature_C*9/5)+32) %>%
select(Temperature_F) %>%
ggplot(metadata,aes(x=Temperature_F, y=Depth_m))
#Exercise 2
#Change from °C to °F
metadata %>%
mutate(Temperature_F = (Temperature_C*9/5)+32) %>%
select(Temperature_F)
#Exercise 2
#Change from °C to °F
metadata %>%
mutate(Temperature_F = (Temperature_C*9/5)+32) %>%
select(Temperature_F)
#Exercise 2
#Change from °C to °F
metadata %>%
mutate(Temperature_F = (Temperature_C*9/5)+32) %>%
select(Temperature_F) %>%
ggplot(., aes(x=Temperature_F, y=Depth_m))+
geom_point()
#Exercise 2
#Change from °C to °F
metadata %>%
mutate(Temperature_F = (Temperature_C*9/5)+32) %>%
select(Temperature_F, Depth_m) %>%
ggplot(., aes(x=Temperature_F, y=Depth_m))+
geom_point()
#Exercise 2
#Change from °C to °F
metadata %>%
mutate(Temperature_F = (Temperature_C*9/5)+32) %>%
select(Temperature_F, Depth_m) %>%
#Plot data
ggplot(., aes(x=Temperature_F, y=Depth_m))+
geom_point()
physeq
plot_bar(physeq, fill="Phylum")
plot_bar(physeq, fill="Phylum")
plot_bar(physeq_percent, fill="Phylum")
#Exercise 3
#convert physeq data to %
physeq_percent = transform_sample_counts(physeq, function(x) 100*x/sum(x))
#Exercise 2
#Change from °C to °F
metadata %>%
mutate(Temperature_F = (Temperature_C*9/5)+32) %>%
select(Temperature_F, Depth_m) %>%
#Plot data
ggplot(., aes(x=Temperature_F, y=Depth_m))+
geom_point()
physeq_percent = transform_sample_counts(physeq, function(x) 100*x/sum(x))
plot_bar(physeq_percent, fill="Phylum")
plot_bar(physeq_percent, fill="Phylum")+
geom_bar(aes(fill=Phylum), stat = "identity")
plot_bar(physeq_percent, fill="Phylum")+
geom_bar(aes(fill=Phylum), stat = "identity")+
title = "Phyla from 10 to 200 m in Saanich Inlet"
plot_bar(physeq_percent, fill="Phylum")+
geom_bar(aes(fill=Phylum), stat = "identity") +
title = "Phyla from 10 to 200 m in Saanich Inlet"
plot_bar(physeq_percent, fill="Phylum")+
geom_bar(aes(fill=Phylum), stat = "identity") +
p + ggtitle("Phyla from 10 to 200 m in Saanich Inlet")+
xlab("Sample depth") + ylab("Percent relative abundance")
plot_bar(physeq_percent, fill="Phylum")+
geom_bar(aes(fill=Phylum), stat = "identity") +
physeq_percent + ggtitle("Phyla from 10 to 200 m in Saanich Inlet")+
xlab("Sample depth") + ylab("Percent relative abundance")
tity") +
physeq_percent = transform_sample_counts(physeq, function(x) 100*x/sum(x))
plot_bar(physeq_percent, fill="Phylum")+
geom_bar(aes(fill=Phylum), stat = "identity") +
ggtitle("Phyla from 10 to 200 m in Saanich Inlet")+
xlab("Sample depth") + ylab("Percent relative abundance")
plot_bar(physeq_percent, fill="Phylum")+
geom_bar(aes(fill=Phylum), stat = "identity")
p+ ggtitle("Phyla from 10 to 200 m in Saanich Inlet")+
xlab("Sample depth") + ylab("Percent relative abundance")
physeq_percent = transform_sample_counts(physeq, function(x) 100*x/sum(x))
p<-plot_bar(physeq_percent, fill="Phylum")+
geom_bar(aes(fill=Phylum), stat = "identity")
p+ ggtitle("Phyla from 10 to 200 m in Saanich Inlet")+
xlab("Sample depth") + ylab("Percent relative abundance")
physeq_percent = transform_sample_counts(physeq, function(x) 100*x/sum(x))
plot_bar(physeq_percent, fill="Phylum")+
geom_bar(aes(fill=Phylum), stat = "identity")+
ggtitle("Phyla from 10 to 200 m in Saanich Inlet")+
xlab("Sample depth") + ylab("Percent relative abundance")
View(metadata)
#Exercise 4
#Gather data in 1 column
metadata_nutrients <- metadata %>%
gather(Nutrient, Concentration, O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM)
View(metadata_nutrients)
View(metadata_nutrients)
#Exercise 4
#Gather data in 1 column
metadata_nutrients <- metadata %>%
gather(Nutrient, Concentration, ......., O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM)
#Exercise 4
#Gather data in 1 column
metadata_nutrients <- metadata %>%
gather(Nutrient, Concentration, 6, O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM)
View(metadata_nutrients)
metadata_nutrients <- metadata %>%
gather(Nutrient, Concentration, 6, O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM)
View(metadata_nutrients)
#Exercise 4
#Gather data in 1 column
metadata_nutrients <- metadata %>%
gather(Nutrient, Concentration, O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM, na.rm = TRUE)
View(metadata_nutrients)
#Exercise 4
#Gather data in 1 column
metadata_nutrients <- metadata %>%
gather(Nutrient, Concentration, O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM, na.rm = TRUE)%>%
select(Nutrient, Concentration)
View(metadata_nutrients)
#Exercise 4
#Gather data in 1 column
metadata_nutrients <- metadata %>%
gather(Nutrient, Concentration, O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM)%>%
select(Nutrient, Concentration)
View(metadata_nutrients)
View(metadata_nutrients)
View(metadata)
#Plot facet plot
ggplot(metadata_nutrients, aes(x=Depth_m))+
geom_bar(aes(fill=Phylum), stat = "identity")+
facet_wrap(~Nutrient, scales="free_y")+
theme(legend.position = "none")
#Plot facet plot
ggplot(metadata_nutrients, aes(x=Depth_m))+
geom_point()
#Exercise 4
#Gather data in 1 column
metadata_nutrients <- metadata %>%
gather(Nutrient, Concentration, Depth_m, O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM)%>%
select(Depth_m, Nutrient, Concentration)
metadata_nutrients <- metadata %>%
gather(Nutrient, Concentration, Depth_m, O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM)%>%
select(Depth_m, Nutrient, Concentration)
#Exercise 4
#Gather data in 1 column
metadata_nutrients <- metadata %>%
gather(Depth, Nutrient, Concentration, Depth_m, O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM)%>%
select(Depth_m, Nutrient, Concentration)
View(metadata_nutrients)
View(metadata_nutrients)
#Exercise 4
#Gather data in 1 column
metadata_nutrients <- metadata %>%
gather(Depth_m, Nutrient, Concentration, Depth_m, O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM)%>%
select(Depth_m, Nutrient, Concentration)
#Exercise 4
#Gather data in 1 column
metadata_nutrients <- metadata %>%
gather(Nutrient, Concentration, Depth_m, O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM)%>%
select(Depth_m, Nutrient, Concentration)
#Plot facet plot
ggplot(metadata_nutrients, aes(x=Depth_m))+
geom_point()
metadata_nutrients <- metadata %>%
gather(Nutrient, Concentration, Depth_m, O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM)%>%
select(Depth_m, Nutrient, Concentration)
#Exercise 4
#Gather data in 1 column
metadata_nutrients <- metadata %>%
gather(Nutrient, Concentration, Sample, Depth_m, O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM)%>%
select(Depth_m, Nutrient, Concentration)
#Exercise 4
#Gather data in 1 column
metadata_nutrients <- metadata %>%
gather(Nutrient, Concentration, Sample, O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM)%>%
select(Nutrient, Concentration)
#Exercise 4
#Gather data in 1 column
metadata_nutrients <- metadata %>%
gather(Nutrient, Concentration, O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM)%>%
select(Nutrient, Concentration)
View(physeq_percent)
#Exercise 4
#Gather data in 1 column
metadata_nutrients <- metadata %>%
gather(Nutrient, Concentration, O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM)%>%
#Plot facet plot
ggplot(metadata_nutrients, aes(x=Depth_m, y=Concentration))+
geom_point()
metadata_nutrients <- metadata %>%
gather(Nutrient, Concentration, O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM)
View(metadata_nutrients)
metadata_nutrients <- metadata %>%
gather(Nutrient, Concentration, O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM)%>%
gather(Sample, Depth, Sample, Depth_m)%>%
Select(Sample, Depth, Nutrient, Concentration)
metadata_nutrients <- metadata %>%
gather(Nutrient, Concentration, O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM)%>%
gather(Sample, Depth, Sample, Depth_m)%>%
select(Sample, Depth, Nutrient, Concentration)
#Exercise 4
#Gather data in 1 column
metadata_nutrients <- metadata %>%
gather(Nutrient, Concentration, O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM)%>%
gather(Sample, Depth, Depth_m)%>%
select(Sample, Depth, Nutrient, Concentration)
metadata_nutrients <- metadata %>%
gather(Nutrient, Concentration, O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM)%>%
gather(Sample, Depth, Depth_m)%>%
select(Sample, Depth, Nutrient, Concentration)
#Exercise 4
#Gather data in 1 column
metadata_nutrients <- metadata %>%
gather(Nutrient, Concentration, O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM)%>%
gather(Sample, Depth, Sample, Depth_m)%>%
select(Sample, Depth, Nutrient, Concentration)
#Exercise 4
#Gather data in 1 column
metadata_nutrients <- metadata %>%
gather(Nutrient, Concentration, O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM)%>%
gather(Sample, Depth, Depth_m)%>%
select(Sample, Depth, Nutrient, Concentration)
#Exercise 4
#Gather data in 1 column
metadata_nutrients <- metadata %>%
gather(Nutrient, Concentration, O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM)%>%
gather(Sample, Depth, Depth_m)%>%
select(Depth, Nutrient, Concentration)
#Exercise 4
#Gather data in 1 column
metadata_nutrients <- metadata %>%
gather(Nutrient, Concentration, O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM)%>%
gather(Sample, Depth, ., Depth_m)%>%
select(Depth, Nutrient, Concentration)
#Exercise 4
#Gather data in 1 column
metadata_nutrients <- metadata %>%
gather(Nutrient, Concentration, O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM)%>%
gather(Sample, Depth, Sample, Depth_m)%>%
select(Depth, Nutrient, Concentration)
#Exercise 4
#Gather data in 1 column
metadata_nutrients <- metadata %>%
gather(Nutrient, Concentration, O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM)%>%
select(Depth_m, Nutrient, Concentration)
ggplot(metadata_nutrients, aes(x=Depth_m, y=Concentration))+
geom_line()+
facet_wrap(~Nutrient, scales="free_y")+
theme(legend.position = "none")
#Plot facet plot
ggplot(metadata_nutrients, aes(x=Depth_m, y=Concentration))+
geom_line()+
geom_point()+
facet_wrap(~Nutrient, scales="free_y")+
theme(legend.position = "none")
#Plot facet plot
ggplot(metadata_nutrients, aes(x=Depth_m, y=Concentration))+
geom_line()+
geom_point()+
facet_wrap(~Nutrient, scales="free_y")+
theme(legend.position = "none")+
ylab("Nutrient Concentration (uM)")
#Plot facet plot
ggplot(metadata_nutrients, aes(x=Depth_m, y=Concentration))+
geom_line()+
geom_point()+
facet_wrap(~Nutrient, scales="free_y")+
theme(legend.position = "none")+
ggtitle("Nutrient Distribution across a depth of 10-200m in Saanich Inlet")
#Plot facet plot
ggplot(metadata_nutrients, aes(x=Depth_m, y=Concentration))+
geom_line()+
geom_point()+
facet_wrap(~Nutrient, scales="free_y")+
theme(legend.position = "none")+
ggtitle("Nutrient Distribution across a depth of 10-200m in Saanich Inlet")+
xlab("Depth (m)")+
ylab("Nutrient Concentration (uM)")
#Plot facet plot
ggplot(metadata_nutrients, aes(x=Depth_m, y=Concentration))+
geom_line()+
geom_point()+
facet_wrap(~Nutrient, scales="free_y")+
theme(legend.position = "none")+
ggtitle("Nutrient distribution across a depth of 10-200m in Saanich Inlet")+
xlab("Depth (m)")+
ylab("Nutrient Concentration (uM)")
#Plot facet plot
ggplot(metadata_nutrients, aes(x=Depth_m, y=Concentration))+
geom_line(color="grey")+
geom_point()+
facet_wrap(~Nutrient, scales="free_y")+
theme(legend.position = "none")+
ggtitle("Nutrient distribution across a depth of 10-200m in Saanich Inlet")+
xlab("Depth (m)")+
ylab("Nutrient Concentration (uM)")
#Plot facet plot
ggplot(metadata_nutrients, aes(x=Depth_m, y=Concentration))+
geom_line(color="grey", size=2)+
geom_point()+
facet_wrap(~Nutrient, scales="free_y")+
theme(legend.position = "none")+
ggtitle("Nutrient distribution across a depth of 10-200m in Saanich Inlet")+
xlab("Depth (m)")+
ylab("Nutrient Concentration (uM)")
#Plot facet plot
ggplot(metadata_nutrients, aes(x=Depth_m, y=Concentration))+
geom_line(color="grey")+
geom_point()+
facet_wrap(~Nutrient, scales="free_y")+
theme(legend.position = "none")+
ggtitle("Nutrient distribution across a depth of 10-200m in Saanich Inlet")+
xlab("Depth (m)")+
ylab("Nutrient Concentration (uM)")
library(tidyverse)
library(phyloseq)
metadata <- read.delim("Saanich.metadata.txt")
OTU <- read.delim("Saanich.OTU.txt")
load("phyloseq_object.RData")
ggplot(metadata, aes(x=NO3_uM, y=Depth_m))+
geom_point(color = "purple", shape=17, size = 1)
#Change from °C to °F
metadata %>%
mutate(Temperature_F = (Temperature_C*9/5)+32) %>%
select(Temperature_F, Depth_m) %>%
#Plot data
ggplot(., aes(x=Temperature_F, y=Depth_m))+
geom_point()
#convert physeq data to % and plot
physeq_percent = transform_sample_counts(physeq, function(x) 100*x/sum(x))
plot_bar(physeq_percent, fill="Phylum")+
geom_bar(aes(fill=Phylum), stat = "identity")+
#Add title and axis labels
ggtitle("Phyla from 10 to 200 m in Saanich Inlet")+
xlab("Sample depth") + ylab("Percent relative abundance")
#Gather data in 1 column
metadata_nutrients <- metadata %>%
gather(Nutrient, Concentration, O2_uM, PO4_uM, SiO2_uM, NO3_uM, NH4_uM, NO2_uM)%>%
select(Depth_m, Nutrient, Concentration)
#Plot facet plot
ggplot(metadata_nutrients, aes(x=Depth_m, y=Concentration))+
geom_line(color="grey")+
geom_point()+
facet_wrap(~Nutrient, scales="free_y")+
theme(legend.position = "none")+
ggtitle("Nutrient distribution across a depth of 10-200m in Saanich Inlet")+
xlab("Depth (m)")+
ylab("Nutrient Concentration (uM)")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(phyloseq)
metadata <- read.delim("Saanich.metadata.txt")
OTU <- read.delim("Saanich.OTU.txt")
load("phyloseq_object.RData")
ggplot(metadata, aes(x=NO3_uM, y=Depth_m))+
geom_point(color = "purple", shape=17, size = 3)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(phyloseq)
metadata <- read.delim("Saanich.metadata.txt")
OTU <- read.delim("Saanich.OTU.txt")
load("phyloseq_object.RData")
ggplot(metadata, aes(x=NO3_uM, y=Depth_m))+
geom_point(color = "purple", shape=17, size = 2)
